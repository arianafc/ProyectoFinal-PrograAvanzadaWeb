@model Usuario
@{
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
    var rol = ViewBag.Rol;
    var nombre = ViewBag.Nombre as string;
    var usuario = ViewBag.IdUsuario;

}

@section Styles {
    <link href="~/css/perfil.css" rel="stylesheet" />
}

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


<input type="hidden" class="TempError" value="@TempData["SwalError"]" />
<input type="hidden" class="TempSuccess" value="@TempData["SwalSuccess"]" />


<div class="perfil-wrapper">
    @if (rol == 1)
    {
        <!-- BOTONES DOCUMENTOS ARRIBA -->
        <div class="row top-buttons mb-4 action-buttons">
            <div class="col-md-6">
                <button data-bs-toggle="modal" data-bs-target="#modalSubirDoc">
                    <i class="fas fa-folder-open me-2"></i> Subir Documentos
                </button>
            </div>
            <div class="col-md-6">
                <button data-bs-toggle="modal" data-bs-target="#modalVerDocs">
                    <i class="fas fa-folder-open me-2"></i> Ver Mis Documentos
                </button>
            </div>
        </div>
    }
    <div class="info-box">
        <div class="perfil-icon">
            <img src="@Url.Content("~/Images/logoSIGEP.png")" alt="Perfil" class="perfil-img" width="65">
        </div>


        <h5 class="section-title">INFORMACIÓN PERSONAL</h5>
        <form asp-action="ActualizarPerfil" asp-controller="Perfil" id="ActualizarPerfil" method="post">

            <div class="row" id="info-personal">
                <div class="col-md-6 form-group">
                    <label>Nombre</label>
                    <input asp-for="Nombre" class="form-control" id="NombrePerfil" />
                     </div>

                <div class="col-md-6 form-group">
                    <label>Primer Apellido</label>
                    <input asp-for="Apellido1" class="form-control" id="Apellido1Perfil" />
                      </div>

                <div class="col-md-6 form-group">
                    <label>Segundo Apellido</label>
                    <input asp-for="Apellido2" class="form-control" id="Apellido2Perfil" />
                    
                </div>

                <div class="col-md-6 form-group">
                    <label>Cédula</label>
                    <input asp-for="Cedula" class="form-control" id="CedulaPerfil" />
                    
                </div>

            
                    <div class="col-md-6 form-group">
                        <label>Fecha de Nacimiento <span class="text-danger">*</span></label>
                    <input asp-for="FechaNacimiento"
                           type="date"
                           class="form-control"
                           id="FechaNacimientoPerfil"
                           required />
                       
                        <span asp-validation-for="FechaNacimiento" class="text-danger"></span>
                    </div>
           
                <div class="col-md-6 form-group">
                    <label>Teléfono</label>
                    <input asp-for="Telefono" class="form-control" id="TelefonoPerfil" />
                                    </div>

                <div class="col-md-6 form-group">
                    <label>Correo Electrónico</label>
                    <input asp-for="Correo" class="form-control" id="CorreoPersonalPerfil" />
                   
                </div>

                <div class="col-md-6 form-group">
                    <label>Sexo / Género</label>
                    @Html.DropDownListFor(m => m.Sexo,
                    new SelectList(
                    new[]
                    {
                                        new { Value = "", Text = "Seleccione..." },
                                        new { Value = "Masculino", Text = "Masculino" },
                                        new { Value = "Femenino", Text = "Femenino" },
                                        new { Value = "No binario", Text = "No binario" },
                                        new { Value = "Otro", Text = "Otro" },
                                        new { Value = "Prefiero no decirlo", Text = "Prefiero no decirlo" }
                    },
                    "Value", "Text",
                    Model.Sexo
                    ),
                                        new { @class = "form-control", @id = "SexoPerfil" }
                                        )
                </div>

                <div class="col-md-6 form-group">
                    <label>Nacionalidad</label>
                      
                    @Html.TextBoxFor(m => m.Nacionalidad, new { @class = "form-control", @id = "NacionalidadPerfil" })
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label">Provincia <span class="text-danger">*</span></label> 
                    @Html.DropDownListFor(m => m.Provincia,
                                        new SelectList(new[]
                                        {
                                        "San José","Alajuela","Cartago","Heredia","Guanacaste","Puntarenas","Limón"
                                        }, Model.Provincia),
                                        "Seleccione una provincia",
                                        new { @class = "form-control", onchange = "cargarCantones()", required = "required" }
                                        )
                </div>

                <div class="col-md-6 mb-3">
                    
                    <label class="form-label">Cantón <span class="text-danger">*</span></label>
                    @Html.DropDownListFor(m => m.Canton,
                                        new SelectList(Enumerable.Empty<string>(), Model.Canton),
                                        "Seleccione un cantón",
                                        new { @class = "form-control", onchange = "cargarDistritos()", required = "required", data_selected = Model.Canton }
                                        )
                </div>

                <div class="col-md-6 mb-3">
                    <label class="form-label">Distrito <span class="text-danger">*</span></label>
                    @Html.DropDownListFor(m => m.Distrito,
                                        new SelectList(Enumerable.Empty<string>(), Model.Distrito),
                                        "Seleccione un distrito",
                                        new { @class = "form-control", required = "required", data_selected = Model.Distrito }
                                        )
                </div>

                <div class="col-md-12 mb-3">
                    <label class="form-label">Dirección Exacta <span class="text-danger">*</span></label>
                    <input asp-for="DireccionExacta" class="form-control" id="DireccionPerfil" />
                </div>
            </div>

            <div class="action-buttons mt-3 mb-4">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-edit me-2"></i> Actualizar Información Personal
                </button>
            </div>
        </form>
        

        <h5 class="section-title">ACTUALIZAR CONTRASEÑA</h5>
        <form class="row" id="ActualizarContrasenna" method="post" asp-action="CambiarContrasenna" asp-controller="Perfil">

            <div class="col-md-12 form-group">
                <label>Contraseña</label>
                <input type="password" class="form-control" id="ContrasennaNueva" asp-for="Contrasenna" name="Contrasenna" placeholder="Ingresa tu contraseña actual" />
              

            </div>
            <div class="col-md-12 form-group">
                <label>Confirmar Contraseña</label>
                <input type="password" class="form-control" id="ContrasennaNuevaPerfil" asp-for="ConfirmarContrasenna" placeholder="Confirma tu contraseña" />

            </div>


            <div class="action-buttons mt-3 mb-4">
                <button type="submit" id="BtnActualizarContrasenna">
                    <i class="fas fa-edit me-2"></i> Actualizar Contraseña
                </button>
            </div>

        </form>
   
        @if (rol == 1)
        {
            <h5 class="section-title">INFORMACIÓN ACADÉMICA</h5>

            if (rol == 1)
            {
                <form class="row" asp-action="ActualizarInfoAcademica" asp-controller="Perfil" method="post" id="ActualizarEspecialidadSecccionForm">
                    <div class=" form-group">
                        @Html.DropDownListFor(
                        model => model.IdEspecialidad,
                                new SelectList(Model.ListaEspecialidades, "IdEspecialidad", "Nombre", Model.IdEspecialidad),
                                "Seleccione una especialidad",
                                new { @class = "form-control" }
                                )
            </div>

            <div class="form-group">
                <label>Sección</label>
                @Html.DropDownListFor(
                                model => model.IdSeccion,
                                new SelectList(Model.ListaSecciones, "IdSeccion", "Seccion", Model.IdSeccion),
                                "Seleccione una sección",
                                new { @class = "form-control" }
                                )
            </div>


            <div class="action-buttons mt-3 mb-4">
                <button type="submit" id="btnActualizarAcademica">
                    <i class="fas fa-edit me-2"></i> Actualizar Información Académica
                </button>
            </div>
                </form>

            }

        }
        @if (rol == 1)
        {
            <!-- CONTACTO EMERGENCIA -->
            <h5 class="section-title">ENCARGADO</h5>
         

                <form asp-action="GuardarEncargado"
                      asp-controller="Perfil"
                      method="post"
                      id="FormEncargado">

                    <div class="row mb-3 p-3 rounded">
                        <input type="hidden" asp-for="EstudianteEncargado.IdEncargado" />
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Cédula</label>
                            <input type="text"
                                   class="form-control"
                                   asp-for="EstudianteEncargado.Cedula" />
                        </div>

                        <div class="col-md-6 mb-3">
                            <label class="form-label">Nombre</label>
                            <input type="text"
                                   class="form-control"
                                   asp-for="EstudianteEncargado.Nombre" />
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Primer Apellido</label>
                            <input type="text"
                                   class="form-control"
                                   asp-for="EstudianteEncargado.Apellido1" />
                        </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Segundo Apellido</label>
                        <input type="text"
                               class="form-control"
                               asp-for="EstudianteEncargado.Apellido2" />
                    </div>

                        <div class="col-md-6 mb-3">
                            <label class="form-label">Teléfono</label>
                            <input type="text"
                                   class="form-control"
                                   asp-for="EstudianteEncargado.Telefono" />
                        </div>

                        <div class="col-md-6 mb-3">
                            <label class="form-label">Parentesco</label>
                            <input type="text"
                                   class="form-control"
                                   asp-for="EstudianteEncargado.Parentesco" />
                        </div>

                        <div class="col-md-6 mb-3">
                            <label class="form-label">Residencia o Trabajo</label>
                            <input type="text"
                                   class="form-control"
                                   asp-for="EstudianteEncargado.LugarTrabajo" />


                        </div>

                        <div class="col-md-6 mb-3">
                            <label class="form-label">Ocupación</label>
                            <input type="text"
                                   class="form-control"
                                   asp-for="EstudianteEncargado.Ocupacion" />
                        </div>

                    <div class="col-md-6 mb-3">
                        <label class="form-label">Correo</label>
                        <input type="email"
                               class="form-control"
                               asp-for="EstudianteEncargado.Correo" />
                    </div>
                    <div class="action-buttons mt-3 mb-4">
                        <button type="submit"  id="BtnVerEncargadosModal">
                                <i class="fas fa-save me-2"></i> Guardar Encargado
                            </button>
                        </div>
                    </div>
                </form>

        }
            @if (rol == 1)
        {
            <h5 class="section-title">INFORMACIÓN MÉDICA</h5>
            <form asp-action="ActualizarInfoMedica" asp-controller="Perfil" method="post" id="ActualizarInformacionMedicaForm" class="row">
                <div class="row">
                    <div class="col-md-6 form-group">
                        <label>Padecimientos</label>
                        <input asp-for="Padecimiento" class="form-control" />
                    </div>
                    <div class="col-md-6 form-group">
                        <label>Medicamentos</label>
                        <input asp-for="Tratamiento" class="form-control" />
                    </div>
                    <div class="col-md-12 form-group">
                        <label>Alergias</label>
                        <input asp-for="Alergia" class="form-control" />
                    </div>
                </div>

                <div class="action-buttons mt-3 mb-4">
                    <button type="submit" id="btnActualizarMedica">
                        <i class="fas fa-edit me-2"></i> Actualizar Información Médica
                    </button>
                </div>
            </form>      
             
        }
    </div>
</div>


<!-- Modal para Subir Documento -->
<div class="modal fade" id="modalSubirDoc" tabindex="-1" aria-labelledby="modalSubirDocLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content" style="border-radius: 10px; background-color: #F2F2F2;">
            <!-- Header -->
            <div class="modal-header" style="background-color: #2D594D; border-top-left-radius: 10px; border-top-right-radius: 10px;">
                <h5 class="modal-title text-white" id="modalSubirDocLabel">Subir Documento</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>

            <!-- Body -->
            <div class="modal-body">
                <form id="formSubirDoc" asp-action="SubirDocumentos" asp-controller="Perfil" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label class="form-label fw-bold" style="color: #2D594D;">Archivo</label>
                        <input type="file" class="form-control" id="ArchivoDoc" name="Archivo" />
                        <div class="mt-2" style="color: #A0A0A0; font-size: 0.9rem;">
                            * Solo archivos .xls, .xlsx o .pdf
                        </div>
                    </div>
                    <input type="hidden" id="IdUsuarioDoc" asp-for="Cedula" />
                    <div class="modal-footer" style="background-color: #F2F2F2; border-bottom-left-radius: 10px; border-bottom-right-radius: 10px;">
                        <button type="button" class="btn btn-secondary" style="background-color: #A0A0A0; border: none;" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" id="btnSubirDoc" class="btn" style="background-color: #2D594D; color: white; border: none;">Subir Documento</button>
                    </div>
                </form>
            </div>

            <!-- Footer -->
            
        </div>
    </div>
</div>

<!-- Modal para Ver Documentos -->
<div class="modal fade" id="modalVerDocs" tabindex="-1" aria-labelledby="modalVerDocsLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 10px; background-color: #F2F2F2;">
            <!-- Header -->
            <div class="modal-header" style="background-color: #2D594D; border-top-left-radius: 10px; border-top-right-radius: 10px;">
                <h5 class="modal-title text-white" id="modalVerDocsLabel">Mis Documentos</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>

            <!-- Body -->
            <div class="modal-body">
                <div class="list-group" id="listaDocumentos">
                </div>
            </div>
        </div>
    </div>
</div>



@section scripts {
    <script src="~/js/alertas/alertas.js"></script>
    <script src="~/js/perfil/direcciones.js"></script>
    <script src="~/js/perfil/perfil.js"></script>
 

}

