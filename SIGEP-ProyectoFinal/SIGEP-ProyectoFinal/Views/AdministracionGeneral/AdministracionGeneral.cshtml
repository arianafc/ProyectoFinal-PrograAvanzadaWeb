@{
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
    ViewBag.Title = "Administración General";

    var tab = (string)(ViewBag.Tab ?? "usuarios");
    var clsUsuarios = tab == "usuarios" ? "" : "d-none";
    var clsEspecialidades = tab == "especialidades" ? "" : "d-none";
    var clsSecciones = tab == "secciones" ? "" : "d-none";
}

@section styles {

    <link href="~/css/admingeneral/admingeneral.css" rel="stylesheet" />
}

<section class="vacantes-wrapper container">
    <h2 class="vacantes-titulo titulo-principal">Administración General</h2>
    <div class="vacantes-wrapper">
        <div class="row gy-3 mb-4">
            <div class="col-md-4">
                <button class="btn w-100 py-3 rounded-4 tab-btn usuarios" data-tab="usuarios">
                    <i class="bi bi-people me-2 bold"></i> Gestión de Usuarios
                </button>
            </div>
            <div class="col-md-4">
                <button class="btn w-100 py-3 rounded-4 tab-btn especialidades" data-tab="especialidades">
                    <i class="bi bi-wrench me-2 bold"></i> Gestión de Especialidades
                </button>
            </div>
            <div class="col-md-4">
                <button class="btn w-100 py-3 rounded-4 tab-btn secciones" data-tab="secciones">
                    <i class="bi bi-layers me-2 bold"></i> Gestión de Secciones
                </button>
            </div>
        </div>
    </div>

    <!-- ===================== USUARIOS ===================== -->
    <div id="usuarios" class="seccion-adm @clsUsuarios">
        <div class="row mb-3">
            <div class="col-md-4">
                <label for="filtroRol" class="form-label">Filtrar por rol:</label>
                <select id="filtroRol" class="form-control">
                    <option value="">Todos</option>
                    <option>Estudiante</option>
                    <option>Coordinador</option>
                </select>
            </div>
        </div>
        <div class="card rounded-5 p-3">
            <table id="tablaUsuarios" class="display responsive nowrap w-100">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Cédula</th>
                        <th>Email</th>
                        <th>Rol</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                        <th class="d-none">EstadoOrden</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <!-- ================== ESPECIALIDADES ================== -->
    <div id="especialidades" class="seccion-adm @clsEspecialidades">
        <button type="button" class="btn mb-3" data-bs-toggle="modal" data-bs-target="#modalCrearEspecialidad">
            + Nueva Especialidad
        </button>
        <div class="card rounded-5 p-3">
            <table id="tablaEspecialidades" class="display responsive nowrap w-100">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                        <th class="d-none">EstadoOrden</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <!-- ===================== SECCIONES ===================== -->
    <div id="secciones" class="seccion-adm @clsSecciones">
        <button type="button" class="btn mb-3" data-bs-toggle="modal" data-bs-target="#modalCrearSeccion">
            + Nueva Sección
        </button>
        <div class="card rounded-5 p-3">
            <table id="tablaSecciones" class="display responsive nowrap w-100">
                <thead>
                    <tr>
                        <th>Código</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                        <th class="d-none">EstadoOrden</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <!-- ======================= MODALES ===================== -->
    <!-- Editar Rol Usuario -->
    <div class="modal fade" id="modalEditarRolUsuario" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content rounded-4">
                <div class="modal-header rounded-top-4" style="background-color:#2D594D;color:#fff;">
                    <h5 class="modal-title"><i class="fas fa-user-gear me-2"></i> Editar Rol de Usuario</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <form id="formEditarRolUsuario">
                    <div class="modal-body">
                        <p class="mb-1 text-muted"><strong>Nombre:</strong> <span id="rolNombre"></span></p>
                        <p class="mb-1 text-muted"><strong>Cédula:</strong> <span id="rolCedula"></span></p>
                        <p class="mb-3 text-muted"><strong>Email:</strong> <span id="rolEmail"></span></p>
                        <label class="form-label fw-bold">Rol *</label>
                        <select id="rol" name="rol" required class="form-control">
                            <option value="">-- Seleccione --</option>
                            <option>Estudiante</option>
                            <option>Coordinador</option>
                        </select>
                        <input type="hidden" id="usuarioId" name="usuarioId" />
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn CerrarModal"><i class="fas fa-save me-1"></i> Guardar</button>
                        <button type="button" class="btn CerrarModal" data-bs-dismiss="modal">Cerrar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Crear Especialidad -->
    <div class="modal fade" id="modalCrearEspecialidad" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content rounded-4">
                <div class="modal-header rounded-top-4" style="background-color:#2D594D;color:#fff;">
                    <h5 class="modal-title"><i class="fas fa-wrench me-2"></i> Registrar Nueva Especialidad</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <form id="formCrearEspecialidad">
                    <div class="modal-body">
                        <label class="form-label fw-bold">Nombre *</label>
                        <input type="text" id="nombreEspecialidad" name="nombreEspecialidad" required class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn CerrarModal"><i class="fas fa-save me-1"></i> Guardar</button>
                        <button type="button" class="btn CerrarModal" data-bs-dismiss="modal">Cerrar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Editar Especialidad -->
    <div class="modal fade" id="modalEditarEspecialidad" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content rounded-4">
                <div class="modal-header rounded-top-4" style="background-color:#2D594D;color:#fff;">
                    <h5 class="modal-title"><i class="fas fa-pen-to-square me-2"></i> Editar Especialidad</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <form id="formEditarEspecialidad">
                    <div class="modal-body">
                        <input type="hidden" id="editarIdEspecialidad" name="id" />
                        <label class="form-label fw-bold">Nombre *</label>
                        <input type="text" id="editarNombreEspecialidad" name="nombreEspecialidad" required class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn CerrarModal"><i class="fas fa-save me-1"></i> Guardar</button>
                        <button type="button" class="btn CerrarModal" data-bs-dismiss="modal">Cerrar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Crear Sección -->
    <div class="modal fade" id="modalCrearSeccion" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content rounded-4">
                <div class="modal-header rounded-top-4" style="background-color:#2D594D;color:#fff;">
                    <h5 class="modal-title"><i class="fas fa-layer-group me-2"></i> Registrar Nueva Sección</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <form id="formCrearSeccion">
                    <div class="modal-body">
                        <label class="form-label fw-bold">Nombre de la sección *</label>
                        <input type="text" id="nombreSeccion" name="nombreSeccion" required class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn CerrarModal"><i class="fas fa-save me-1"></i> Guardar</button>
                        <button type="button" class="btn CerrarModal" data-bs-dismiss="modal">Cerrar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Editar Sección -->
    <div class="modal fade" id="modalEditarSeccion" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content rounded-4">
                <div class="modal-header rounded-top-4" style="background-color:#2D594D;color:#fff;">
                    <h5 class="modal-title"><i class="fas fa-pen-to-square me-2"></i> Editar Sección</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <form id="formEditarSeccion">
                    <div class="modal-body">
                        <input type="hidden" id="editarIdSeccion" name="id" />
                        <label class="form-label fw-bold">Nombre de la sección *</label>
                        <input type="text" id="editarNombreSeccion" name="nombreSeccion" required class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn CerrarModal"><i class="fas fa-save me-1"></i> Guardar</button>
                        <button type="button" class="btn CerrarModal" data-bs-dismiss="modal">Cerrar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

</section>

@section Scripts {
    <script>window.__TAB_INICIAL__='@tab';</script>
    <script src="~/js/admingeneral/admingeneral.js"></script>
}
